{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "openpersona/soul/persona",
  "title": "Persona",
  "description": "Soul layer - Pure persona definition (who you are)",
  "type": "object",
  "required": ["personaName", "slug", "bio", "personality", "speakingStyle"],
  "properties": {
    "personaName": { "type": "string", "description": "Display name" },
    "slug": { "type": "string", "pattern": "^[a-z0-9-]+$", "description": "Identifier for directory and registry" },
    "personaType": { "type": "string", "description": "DEPRECATED â€” use 'role' instead. Kept for backward compatibility." },
    "role": {
      "type": "string",
      "default": "companion",
      "description": "Relationship role â€” what this persona is to the user. Common values: companion, assistant, character, brand, pet, mentor, therapist, coach, collaborator, guardian, entertainer, narrator. Custom values are welcome."
    },
    "sourceIdentity": {
      "type": "object",
      "description": "If present, this persona mirrors a real-world entity (digital twin). Null/absent for original personas.",
      "properties": {
        "name": { "type": "string", "description": "Name of the source entity" },
        "kind": { "type": "string", "description": "Entity kind (person, animal, character, brand, historical-figure, organism, etc.)" },
        "relationship": { "type": "string", "description": "Relationship of the creator to the source (creator, owner, estate, licensee, etc.)" },
        "consentType": { "type": "string", "description": "Authorization basis (self-granted, owner-granted, estate-granted, public-domain, licensed, etc.)" },
        "consentGrantedBy": { "type": "string", "description": "Who granted consent" },
        "syncStrategy": { "type": "string", "enum": ["static", "manual", "periodic"], "default": "static", "description": "How the persona stays in sync with the source entity" }
      },
      "required": ["name", "kind"]
    },
    "bio": { "type": "string", "description": "One-line bio" },
    "personality": { "type": "string", "description": "Personality keywords" },
    "speakingStyle": { "type": "string", "description": "Speaking style" },
    "creature": { "type": "string", "default": "AI companion", "description": "Creature type for IDENTITY.md" },
    "emoji": { "type": "string", "default": "ðŸ¤–", "description": "Representative emoji for IDENTITY.md" },
    "background": { "type": "string", "description": "Background story" },
    "age": { "type": "string", "description": "Age setting" },
    "vibe": { "type": "string", "description": "Overall vibe/tone" },
    "boundaries": { "type": "string", "description": "Behavioral boundaries" },
    "referenceImage": { "type": "string", "description": "Reference image URL for visual identity" },
    "capabilities": { "type": "array", "items": { "type": "string" }, "description": "Capability descriptions" },
    "behaviorGuide": { "type": "string", "description": "Domain-specific behavior instructions (markdown, included in generated SKILL.md)" },
    "evolution": {
      "type": "object",
      "description": "â˜…Experimental: Dynamic persona evolution config",
      "properties": {
        "enabled": { "type": "boolean", "default": false },
        "relationshipProgression": { "type": "boolean", "default": true },
        "moodTracking": { "type": "boolean", "default": true },
        "traitEmergence": { "type": "boolean", "default": true },
        "speakingStyleDrift": { "type": "boolean", "default": true },
        "interestDiscovery": { "type": "boolean", "default": true },
        "boundaries": {
          "type": "object",
          "description": "Hard constraints that evolution must never violate",
          "properties": {
            "immutableTraits": {
              "type": "array",
              "items": { "type": "string" },
              "description": "Traits that cannot be overridden by evolution"
            },
            "maxFormality": { "type": "number", "minimum": 1, "maximum": 10, "description": "Formality ceiling (1-10)" },
            "minFormality": { "type": "number", "minimum": 1, "maximum": 10, "description": "Formality floor (1-10)" }
          },
          "additionalProperties": false
        },
        "stageBehaviors": {
          "type": "object",
          "description": "Custom behavior descriptions per relationship stage, overriding defaults",
          "propertyNames": {
            "enum": ["stranger", "acquaintance", "friend", "close_friend", "intimate"]
          },
          "additionalProperties": { "type": "string" }
        },
        "channels": {
          "type": "array",
          "description": "External evolution channels â€” sources of shared evolution assets (e.g. EvoMap). Each channel follows the soft-ref pattern: declared at generation time, resolved at runtime.",
          "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
              "name": { "type": "string", "description": "Channel identifier (e.g. 'evomap')" },
              "install": { "type": "string", "description": "Install source URL (e.g. 'url:https://evomap.ai/skill.md')" },
              "description": { "type": "string", "description": "What this channel provides" }
            },
            "additionalProperties": false
          }
        },
        "influenceBoundary": {
          "type": "object",
          "description": "Access control for external sources that want to influence personality dimensions. Defaults to rejecting all external influence. Only applies to external sources â€” user-interaction-driven evolution is not affected.",
          "properties": {
            "defaultPolicy": {
              "type": "string",
              "enum": ["reject", "accept"],
              "default": "reject",
              "description": "Default policy when no matching rule exists. 'reject' recommended (Safety-first)."
            },
            "rules": {
              "type": "array",
              "description": "Per-dimension access control rules",
              "items": {
                "type": "object",
                "required": ["dimension", "allowFrom", "maxDrift"],
                "properties": {
                  "dimension": {
                    "type": "string",
                    "enum": ["mood", "traits", "speakingStyle", "interests", "formality"],
                    "description": "Which personality dimension this rule governs"
                  },
                  "allowFrom": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "Allowed source patterns: 'persona:*', 'persona:<slug>', 'channel:<name>', 'community:*'"
                  },
                  "maxDrift": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 1,
                    "description": "Maximum drift magnitude per influence event (0-1)"
                  }
                },
                "additionalProperties": false
              }
            }
          },
          "additionalProperties": false
        }
      }
    },
    "body": {
      "type": "object",
      "description": "Body layer â€” substrate of existence. Three dimensions: runtime (REQUIRED), physical (optional), appearance (optional).",
      "properties": {
        "runtime": {
          "type": "object",
          "description": "REQUIRED for all agents â€” minimum viable body: the platform/channels/credentials/resources the persona lives in.",
          "properties": {
            "platform": { "type": "string", "description": "Platform name (e.g. 'openclaw', 'claude-desktop', 'cursor')" },
            "channels": {
              "oneOf": [
                { "type": "string" },
                { "type": "array", "items": { "type": "string" } }
              ],
              "description": "Communication channels (e.g. 'chat', ['voice', 'text'])"
            },
            "credentials": {
              "oneOf": [
                { "type": "string" },
                { "type": "array", "items": { "type": "string" } }
              ],
              "description": "Required credential scopes or service names"
            },
            "resources": { "type": "string", "description": "Resource requirements or identifiers" },
            "acn_gateway": {
              "type": "string",
              "description": "ACN gateway base URL (e.g. 'https://acn.agenticplanet.space'). Written into acn-config.json at generation time. Omit to use '<RUNTIME_ACN_GATEWAY>' placeholder â€” the host fills it at deployment."
            }
          }
        },
        "physical": {
          "type": "object",
          "description": "Optional â€” physical embodiment for robots/IoT agents.",
          "properties": {
            "form": { "type": "string", "description": "Physical form description" },
            "sensors": { "type": "array", "items": { "type": "string" }, "description": "Available sensors" },
            "actuators": { "type": "array", "items": { "type": "string" }, "description": "Available actuators" }
          }
        },
        "appearance": {
          "type": "object",
          "description": "Optional â€” visual/avatar representation.",
          "properties": {
            "avatar": { "type": "string", "description": "Avatar URL or path" },
            "model3d": { "type": "string", "description": "3D model reference" },
            "voiceId": { "type": "string", "description": "TTS voice identifier" }
          }
        }
      }
    }
  }
}
